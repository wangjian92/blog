{"code":"(window.webpackJsonp=window.webpackJsonp||[]).push([[33],{357:function(s,t,a){\"use strict\";a.r(t);var n=a(0),e=Object(n.a)({},(function(){var s=this,t=s.$createElement,a=s._self._c||t;return a(\"ContentSlotsDistributor\",{attrs:{\"slot-key\":s.$parent.slotKey}},[a(\"h2\",{attrs:{id:\"写在前面的话\"}},[a(\"a\",{staticClass:\"header-anchor\",attrs:{href:\"#写在前面的话\"}},[s._v(\"#\")]),s._v(\" 写在前面的话\")]),s._v(\" \"),a(\"p\",[s._v(\"原本在 vultr 上面购买的 VPS 上面搭建的 shadowsocks 不能用了，具体原因就是 GTW 经过一波加强，可以通过 TCP 阻断来封锁一些用于搭建 VPN 的 VPS。TCP 阻断的结果就是在国内无法通过 tcp 来连接访问国外的 VPS，从而在国内无法 ssh 登录 VPS，但是使用 ping 工具却能 ping 通被 tcp 阻断的服务器，因为 ping 是基于 ICMP 的。这样给人一种 VPS 没被封的错觉。\")]),s._v(\" \"),a(\"p\",[s._v(\"当 VPS 被 TCP 阻断时，原本基于 shadowsocks 的科学上网方式就不能使用了，本文就是针对被 TCP 阻断的 VPS，通过 v2ray 来实现科学上网。当然对于没有被 TCP 阻断的 VPS 使用该方法来搭梯子也不容易被封。\")]),s._v(\" \"),a(\"p\",[s._v(\"本文分为两个部分：服务端篇和客户端篇。服务端篇的主要内容是在 VPS 上搭建 v2ray+nginx 环境（因为服务器在海外，所以需要 nginx 做代理）；客户端篇则介绍 v2ray 客户端的安装及配置方法。\")]),s._v(\" \"),a(\"blockquote\",[a(\"p\",[s._v(\"特别感谢 \"),a(\"a\",{attrs:{href:\"https://github.com/xuxihai123\",target:\"_blank\",rel:\"noopener noreferrer\"}},[s._v(\"xuxihai123\"),a(\"OutboundLink\")],1),s._v(\" 的技术指导。\")])]),s._v(\" \"),a(\"h2\",{attrs:{id:\"服务端篇\"}},[a(\"a\",{staticClass:\"header-anchor\",attrs:{href:\"#服务端篇\"}},[s._v(\"#\")]),s._v(\" 服务端篇\")]),s._v(\" \"),a(\"p\",[s._v(\"和其它的网络代理工具一样，需要一台配置了 V2Ray 的服务器，然后在自己的设备上安装 V2Ray 客户端，之后就可以流畅地访问互联网。一个 V2Ray 服务器可同时支持多台设备，使用不同的代理协议访问。同时，经过合理的配置，V2Ray 可以识别并区分需要代理和不需要代理的流量，直连的流量不需要绕路。\")]),s._v(\" \"),a(\"mermaid\",{staticClass:\"center\"},[s._v(\"\\ngraph LR;\\nA(PC) -.- B(Firewall);\\nB -.-> C(Blocked Website);\\nA --\\x3e D(V2Ray/VPS);\\nD --\\x3e C;\\nA --\\x3e E(Normal Website);\\n\")]),s._v(\" \"),a(\"p\",[s._v(\"主要流程是：准备自己的 VPS，DNS，CDN，在 VPS 上搭建 v2ray 环境，通过 nginx+websocket 代理到 CDN，利用 CDN 隐藏网站 ip。下面一步一步来：\")]),s._v(\" \"),a(\"h3\",{attrs:{id:\"_1-vps\"}},[a(\"a\",{staticClass:\"header-anchor\",attrs:{href:\"#_1-vps\"}},[s._v(\"#\")]),s._v(\" 1.VPS\")]),s._v(\" \"),a(\"p\",[s._v(\"VPS 这里我选用的是 \"),a(\"a\",{attrs:{href:\"https://www.vultr.com\",target:\"_blank\",rel:\"noopener noreferrer\"}},[s._v(\"vultr\"),a(\"OutboundLink\")],1),s._v(\"，关于 vultr 的购买和配置可以参考我的另一篇文档\"),a(\"a\",{attrs:{href:\"https://github.com/wangjian92/ShadowSocks\",target:\"_blank\",rel:\"noopener noreferrer\"}},[s._v(\"https://github.com/wangjian92/ShadowSocks\"),a(\"OutboundLink\")],1),s._v(\"的第一、二章部分。\")]),s._v(\" \"),a(\"p\",[s._v(\"这里最好选择 CentOS7 的服务，之前我在 CentOS8 上遇到了一些因系统版本太高而导致的问题。\")]),s._v(\" \"),a(\"h3\",{attrs:{id:\"_2-dns\"}},[a(\"a\",{staticClass:\"header-anchor\",attrs:{href:\"#_2-dns\"}},[s._v(\"#\")]),s._v(\" 2.DNS\")]),s._v(\" \"),a(\"p\",[s._v(\"域名我选择的是\"),a(\"a\",{attrs:{href:\"https://cloud.tencent.com/\",target:\"_blank\",rel:\"noopener noreferrer\"}},[s._v(\"腾讯云\"),a(\"OutboundLink\")],1),s._v(\"，选择自己想要的域名之后进行购买，这里是传送门：\"),a(\"a\",{attrs:{href:\"https://dnspod.cloud.tencent.com/\",target:\"_blank\",rel:\"noopener noreferrer\"}},[s._v(\"https://dnspod.cloud.tencent.com/\"),a(\"OutboundLink\")],1),s._v(\"，可能需要几分钟时间进行实名认证等操作，一切准备就绪后，进入腾讯云的域名管理\"),a(\"a\",{attrs:{href:\"https://console.cloud.tencent.com/domain\",target:\"_blank\",rel:\"noopener noreferrer\"}},[s._v(\"https://console.cloud.tencent.com/domain\"),a(\"OutboundLink\")],1),s._v(\"，查看服务状态是否为正常。\")]),s._v(\" \"),a(\"p\",[s._v(\"之后可以在自己域名后的\"),a(\"code\",[s._v(\"操作\")]),s._v(\"一栏，进入\"),a(\"code\",[s._v(\"管理\")]),s._v(\"，在\"),a(\"code\",[s._v(\"基本信息\")]),s._v(\"中有一条\"),a(\"code\",[s._v(\"DNS服务器\")]),s._v(\"，这里有两个地址需要修改，可以先记着不用管，待第 3 步 CDN 配置好之后填入。\")]),s._v(\" \"),a(\"h3\",{attrs:{id:\"_3-cdn\"}},[a(\"a\",{staticClass:\"header-anchor\",attrs:{href:\"#_3-cdn\"}},[s._v(\"#\")]),s._v(\" 3.CDN\")]),s._v(\" \"),a(\"p\",[s._v(\"CDN 加速，我这里选用的是\"),a(\"a\",{attrs:{href:\"https://dash.cloudflare.com\",target:\"_blank\",rel:\"noopener noreferrer\"}},[s._v(\"CloudFlare\"),a(\"OutboundLink\")],1),s._v(\",这是美国的一家 IT 企业，这里利用它来进行 CDN 加速，并\"),a(\"strong\",[s._v(\"隐藏你的网站\")]),s._v(\"，这是可以让我们看到外面的世界的很重要的一步，进入 CloudFlare 官网也就是刚才的链接之后，使用自己的邮箱进行注册，注册成功后需要一些配置：\")]),s._v(\" \"),a(\"ul\",[a(\"li\",[s._v(\"点击右上角的\"),a(\"code\",[s._v(\"Add Site\")]),s._v(\"，这里会让你输入一个地址，这个地址就是第 2 步骤中申请好的 DNS 域名，比如\"),a(\"code\",[s._v(\"example.com\")])]),s._v(\" \"),a(\"li\",[s._v(\"进入你添加好的 Site(左上角可以选择并进入)\")]),s._v(\" \"),a(\"li\",[s._v(\"进入 DNS 的配置界面，这里点击\"),a(\"code\",[s._v(\"Add record\")]),s._v(\"，添加一条子域名，type 就选\"),a(\"code\",[s._v(\"A\")]),s._v(\"，name 我写的\"),a(\"code\",[s._v(\"sky\")]),s._v(\"（这里可以自由发挥），IPv4 address 填入步骤 1 中配置好的 VPS 的 ip 地址，其他选项不用动，Save 就好，这样完成了一条子域名的配置，这里了我配置了两条，分别是\"),a(\"code\",[s._v(\"sky\")]),s._v(\"和\"),a(\"code\",[s._v(\"www\")])]),s._v(\" \"),a(\"li\",[s._v(\"紧接着下面有一栏是\"),a(\"code\",[s._v(\"Cloudflare nameservers\")]),s._v(\"，也就是域名服务器，可以看到有两条\"),a(\"code\",[s._v(\"NS\")]),s._v(\"，将这两个地址分别填入第 2 步域名的\"),a(\"code\",[s._v(\"DNS服务器\")]),s._v(\"配置中去。\")]),s._v(\" \"),a(\"li\",[s._v(\"之后进入\"),a(\"code\",[s._v(\"SSL/TLS\")]),s._v(\"，设置 SSL/TLS 加密方式为\"),a(\"code\",[s._v(\"Full\")])])]),s._v(\" \"),a(\"p\",[s._v(\"配置完成过后，可任选其一检测自己的 CDN 是否配置成功：\")]),s._v(\" \"),a(\"ul\",[a(\"li\",[s._v(\"打开本地 cmd，ping 一下自己刚才建好的子域名是否可以 ping 通，这里拿我的配置举例：\")])]),s._v(\" \"),a(\"div\",{staticClass:\"language-bash line-numbers-mode\"},[a(\"pre\",{pre:!0,attrs:{class:\"language-bash\"}},[a(\"code\",[a(\"span\",{pre:!0,attrs:{class:\"token function\"}},[s._v(\"ping\")]),s._v(\" sky.wangjian92.top\\n\"),a(\"span\",{pre:!0,attrs:{class:\"token function\"}},[s._v(\"ping\")]),s._v(\" www.wangjian92.top\\n\")])]),s._v(\" \"),a(\"div\",{staticClass:\"line-numbers-wrapper\"},[a(\"span\",{staticClass:\"line-number\"},[s._v(\"1\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[s._v(\"2\")]),a(\"br\")])]),a(\"p\",[s._v(\"我这里看到 ip 是\"),a(\"code\",[s._v(\"104.24\")]),s._v(\"开头的，是正确的\")]),s._v(\" \"),a(\"ul\",[a(\"li\",[s._v(\"或者可以打开本地浏览器，在地址栏直接输入这两个地址，看是否有页面\")]),s._v(\" \"),a(\"li\",[s._v(\"或者进入\"),a(\"a\",{attrs:{href:\"http://ip.tool.chinaz.com/sky.wangjian92.top\",target:\"_blank\",rel:\"noopener noreferrer\"}},[s._v(\"http://ip.tool.chinaz.com/sky.wangjian92.top\"),a(\"OutboundLink\")],1),s._v(\"，\"),a(\"a\",{attrs:{href:\"http://whois.chinaz.com/wangjian92.top\",target:\"_blank\",rel:\"noopener noreferrer\"}},[s._v(\"http://whois.chinaz.com/wangjian92.top\"),a(\"OutboundLink\")],1),s._v(\"这两个网站输入自己的域名看是否展示详细信息\")])]),s._v(\" \"),a(\"p\",[s._v(\"如果可以 ping 通或者可以看到自己域名的信息，则进行之后的服务器端操作，如果不行，可以检查一下之前的配置步骤。\")]),s._v(\" \"),a(\"h3\",{attrs:{id:\"_4-v2ray\"}},[a(\"a\",{staticClass:\"header-anchor\",attrs:{href:\"#_4-v2ray\"}},[s._v(\"#\")]),s._v(\" 4.v2ray\")]),s._v(\" \"),a(\"p\",[s._v(\"完成了之前三步的准备工作，即可通过 ssh 或者 xshell 工具链接服务器，安装及配置 v2ray 和 nginx 代理。\")]),s._v(\" \"),a(\"p\",[a(\"a\",{attrs:{href:\"https://github.com/v2ray/v2ray-core\",target:\"_blank\",rel:\"noopener noreferrer\"}},[a(\"strong\",[s._v(\"v2ray\")]),a(\"OutboundLink\")],1),s._v(\"是 Project V 下的一个工具。Project V 是一个包含一系列构建特定网络环境工具的项目，而 V2Ray 属于最核心的一个。简单地说，V2Ray 是一个与 Shadowsocks 类似的代理软件，用于构建代理绕过网络限制的平台，但它俩还是有区别的，Shadowsocks 只是一个简单的代理工具，而 V2Ray 定位为一个平台，任何开发者都可以利用 V2Ray 提供的模块开发出新的代理软件。\")]),s._v(\" \"),a(\"p\",[s._v(\"在 Linux 操作系统， V2Ray 的安装有脚本安装、手动安装、编译安装 3 种方式，选择其中一种即可，本指南仅提供使用使用脚本安装的方法，并仅推荐使用脚本安装，该脚本由 V2Ray 官方提供。该脚本仅可以在 Debian 系列或者支持 Systemd 的 Linux 操作系统使用。有兴趣的朋友可以进入官网文档\"),a(\"a\",{attrs:{href:\"https://www.v2ray.com/chapter_00/install.html\",target:\"_blank\",rel:\"noopener noreferrer\"}},[s._v(\"https://www.v2ray.com/chapter_00/install.html\"),a(\"OutboundLink\")],1),s._v(\"查看其他安装方式及文档。\")]),s._v(\" \"),a(\"p\",[s._v(\"首先下载脚本：\")]),s._v(\" \"),a(\"div\",{staticClass:\"language-bash line-numbers-mode\"},[a(\"pre\",{pre:!0,attrs:{class:\"language-bash\"}},[a(\"code\",[a(\"span\",{pre:!0,attrs:{class:\"token function\"}},[s._v(\"wget\")]),s._v(\" https://install.direct/go.sh\\n\")])]),s._v(\" \"),a(\"div\",{staticClass:\"line-numbers-wrapper\"},[a(\"span\",{staticClass:\"line-number\"},[s._v(\"1\")]),a(\"br\")])]),a(\"p\",[s._v(\"然后执行脚本安装 V2Ray\")]),s._v(\" \"),a(\"div\",{staticClass:\"language-bash line-numbers-mode\"},[a(\"pre\",{pre:!0,attrs:{class:\"language-bash\"}},[a(\"code\",[a(\"span\",{pre:!0,attrs:{class:\"token function\"}},[s._v(\"sudo\")]),s._v(\" \"),a(\"span\",{pre:!0,attrs:{class:\"token function\"}},[s._v(\"bash\")]),s._v(\" go.sh\\n\")])]),s._v(\" \"),a(\"div\",{staticClass:\"line-numbers-wrapper\"},[a(\"span\",{staticClass:\"line-number\"},[s._v(\"1\")]),a(\"br\")])]),a(\"p\",[s._v(\"安装顺利的话会看到\"),a(\"code\",[s._v(\"V2Ray is installed\")]),s._v(\"的类似信息，如果安装不成功脚本会有红色的提示语句，这个时候应当按照提示除错，除错后再重新执行一遍脚本安装 V2Ray。在安装结果中会看到\"),a(\"code\",[s._v(\"PORT\")]),s._v(\"和\"),a(\"code\",[s._v(\"UUID\")]),s._v(\"的信息，这两个都是随机生成的，不用担心与别人重复。可以暂且记下在之后的步骤中用，不过没记住也能在\"),a(\"code\",[s._v(\"/etc/v2ray/config.json\")]),s._v(\"中找到。\")]),s._v(\" \"),a(\"p\",[s._v(\"安装完之后，使用以下命令启动 V2Ray\")]),s._v(\" \"),a(\"div\",{staticClass:\"language-bash line-numbers-mode\"},[a(\"pre\",{pre:!0,attrs:{class:\"language-bash\"}},[a(\"code\",[a(\"span\",{pre:!0,attrs:{class:\"token function\"}},[s._v(\"sudo\")]),s._v(\" systemctl start v2ray\\n\")])]),s._v(\" \"),a(\"div\",{staticClass:\"line-numbers-wrapper\"},[a(\"span\",{staticClass:\"line-number\"},[s._v(\"1\")]),a(\"br\")])]),a(\"p\",[s._v(\"在首次安装完成之后，V2Ray 不会自动启动，需要手动运行上述启动命令。而在已经运行 V2Ray 的 VPS 上再次执行安装脚本，安装脚本会自动停止 V2Ray 进程，升级 V2Ray 程序，然后自动运行 V2Ray。在升级过程中，配置文件不会被修改。\")]),s._v(\" \"),a(\"p\",[s._v(\"对于安装脚本，还有更多用法，在此不多说了，可以执行 \"),a(\"code\",[s._v(\"bash go.sh -h\")]),s._v(\" 看帮助。\")]),s._v(\" \"),a(\"p\",[s._v(\"查看 v2ray 默认配置\")]),s._v(\" \"),a(\"div\",{staticClass:\"language-bash line-numbers-mode\"},[a(\"pre\",{pre:!0,attrs:{class:\"language-bash\"}},[a(\"code\",[a(\"span\",{pre:!0,attrs:{class:\"token function\"}},[s._v(\"cat\")]),s._v(\" /etc/v2ray/config.json\\n\")])]),s._v(\" \"),a(\"div\",{staticClass:\"line-numbers-wrapper\"},[a(\"span\",{staticClass:\"line-number\"},[s._v(\"1\")]),a(\"br\")])]),a(\"div\",{staticClass:\"custom-block tip\"},[a(\"p\",[s._v(\"了解一下 V2Ray 的工作原理，以下是单个 V2Ray 进程的内部结构示意图。多个 V2Ray 之间互相独立，互不影响。\")]),s._v(\" \"),a(\"mermaid\",{staticClass:\"center\"},[s._v(\"\\ngraph TD;\\nA1(inbound) --\\x3e D(Dispatcher / Router / DNS);\\nA2(inbound) --\\x3e D;\\nD --\\x3e B1(outbound);\\nD --\\x3e B2(outbound);\\n\")]),s._v(\" \"),a(\"ul\",[a(\"li\",[s._v(\"需要配置至少一个入站协议（inbound）和一个出站协议（outbound）才可以正常工作\\n\"),a(\"ul\",[a(\"li\",[s._v(\"入站协议负责与客户端（如浏览器）通信：\\n\"),a(\"ul\",[a(\"li\",[s._v(\"入站协议通常可以配置用户认证，如 ID 和密码等；\")]),s._v(\" \"),a(\"li\",[s._v(\"入站协议收到数据之后，会交给分发器（Dispatcher）进行分发；\")])])]),s._v(\" \"),a(\"li\",[s._v(\"出站协议负责将数据发给服务器，如另一台主机上的 V2Ray。\")])])]),s._v(\" \"),a(\"li\",[s._v(\"当有多个出站协议时，可以配置路由（Routing）来指定某一类流量由某一个出站协议发出。\\n\"),a(\"ul\",[a(\"li\",[s._v(\"路由会在必要时查询 DNS 以获取更多信息来进行判断\")])])])]),s._v(\" \"),a(\"p\",[s._v(\"配置文档可参考 \"),a(\"a\",{attrs:{href:\"https://www.v2ray.com/chapter_02/01_overview.html\",target:\"_blank\",rel:\"noopener noreferrer\"}},[s._v(\"v2ray 配置文档\"),a(\"OutboundLink\")],1)])],1),s._v(\" \"),a(\"p\",[s._v(\"修改配置\")]),s._v(\" \"),a(\"div\",{staticClass:\"language-json line-numbers-mode\"},[a(\"pre\",{pre:!0,attrs:{class:\"language-json\"}},[a(\"code\",[a(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v(\"{\")]),s._v(\"\\n  \"),a(\"span\",{pre:!0,attrs:{class:\"token property\"}},[s._v('\"inbounds\"')]),a(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[s._v(\":\")]),s._v(\" \"),a(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v(\"[\")]),s._v(\"\\n    \"),a(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v(\"{\")]),s._v(\"\\n      \"),a(\"span\",{pre:!0,attrs:{class:\"token property\"}},[s._v('\"port\"')]),a(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[s._v(\":\")]),s._v(\" \"),a(\"span\",{pre:!0,attrs:{class:\"token number\"}},[s._v(\"31523\")]),a(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v(\",\")]),s._v(\" \"),a(\"span\",{pre:!0,attrs:{class:\"token comment\"}},[s._v(\"// v2ray启动端口\")]),s._v(\"\\n      \"),a(\"span\",{pre:!0,attrs:{class:\"token property\"}},[s._v('\"protocol\"')]),a(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[s._v(\":\")]),s._v(\" \"),a(\"span\",{pre:!0,attrs:{class:\"token string\"}},[s._v('\"vmess\"')]),a(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v(\",\")]),s._v(\"\\n      \"),a(\"span\",{pre:!0,attrs:{class:\"token property\"}},[s._v('\"settings\"')]),a(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[s._v(\":\")]),s._v(\" \"),a(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v(\"{\")]),s._v(\"\\n        \"),a(\"span\",{pre:!0,attrs:{class:\"token property\"}},[s._v('\"clients\"')]),a(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[s._v(\":\")]),s._v(\" \"),a(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v(\"[\")]),s._v(\"\\n          \"),a(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v(\"{\")]),s._v(\"\\n            \"),a(\"span\",{pre:!0,attrs:{class:\"token property\"}},[s._v('\"id\"')]),a(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[s._v(\":\")]),s._v(\" \"),a(\"span\",{pre:!0,attrs:{class:\"token string\"}},[s._v('\"*****\"')]),a(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v(\",\")]),s._v(\" \"),a(\"span\",{pre:!0,attrs:{class:\"token comment\"}},[s._v(\"// UUID，这里我做了脱敏\")]),s._v(\"\\n            \"),a(\"span\",{pre:!0,attrs:{class:\"token property\"}},[s._v('\"level\"')]),a(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[s._v(\":\")]),s._v(\" \"),a(\"span\",{pre:!0,attrs:{class:\"token number\"}},[s._v(\"1\")]),a(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v(\",\")]),s._v(\"\\n            \"),a(\"span\",{pre:!0,attrs:{class:\"token property\"}},[s._v('\"alterId\"')]),a(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[s._v(\":\")]),s._v(\" \"),a(\"span\",{pre:!0,attrs:{class:\"token number\"}},[s._v(\"64\")]),s._v(\"\\n          \"),a(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v(\"}\")]),s._v(\"\\n        \"),a(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v(\"]\")]),s._v(\"\\n      \"),a(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v(\"}\")]),a(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v(\",\")]),s._v(\"\\n      \"),a(\"span\",{pre:!0,attrs:{class:\"token comment\"}},[s._v(\"// 使用websocket传输必须设置 (为nginx代理websocket做铺垫)，需要添加\")]),s._v(\"\\n      \"),a(\"span\",{pre:!0,attrs:{class:\"token property\"}},[s._v('\"streamSettings\"')]),a(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[s._v(\":\")]),s._v(\" \"),a(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v(\"{\")]),s._v(\"\\n        \"),a(\"span\",{pre:!0,attrs:{class:\"token property\"}},[s._v('\"network\"')]),a(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[s._v(\":\")]),s._v(\" \"),a(\"span\",{pre:!0,attrs:{class:\"token string\"}},[s._v('\"ws\"')]),a(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v(\",\")]),s._v(\"\\n        \"),a(\"span\",{pre:!0,attrs:{class:\"token property\"}},[s._v('\"wsSettings\"')]),a(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[s._v(\":\")]),s._v(\" \"),a(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v(\"{\")]),s._v(\"\\n          \"),a(\"span\",{pre:!0,attrs:{class:\"token property\"}},[s._v('\"path\"')]),a(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[s._v(\":\")]),s._v(\" \"),a(\"span\",{pre:!0,attrs:{class:\"token string\"}},[s._v('\"/ray\"')]),s._v(\" \"),a(\"span\",{pre:!0,attrs:{class:\"token comment\"}},[s._v(\"// 这里要配nginx中配置的代理，在下一节有用\")]),s._v(\"\\n        \"),a(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v(\"}\")]),s._v(\"\\n      \"),a(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v(\"}\")]),s._v(\"\\n    \"),a(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v(\"}\")]),s._v(\"\\n  \"),a(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v(\"]\")]),a(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v(\",\")]),s._v(\"\\n  \"),a(\"span\",{pre:!0,attrs:{class:\"token property\"}},[s._v('\"outbounds\"')]),a(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[s._v(\":\")]),s._v(\" \"),a(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v(\"[\")]),s._v(\"\\n    \"),a(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v(\"{\")]),s._v(\"\\n      \"),a(\"span\",{pre:!0,attrs:{class:\"token property\"}},[s._v('\"protocol\"')]),a(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[s._v(\":\")]),s._v(\" \"),a(\"span\",{pre:!0,attrs:{class:\"token string\"}},[s._v('\"freedom\"')]),a(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v(\",\")]),s._v(\"\\n      \"),a(\"span\",{pre:!0,attrs:{class:\"token property\"}},[s._v('\"settings\"')]),a(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[s._v(\":\")]),s._v(\" \"),a(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v(\"{\")]),a(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v(\"}\")]),s._v(\"\\n    \"),a(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v(\"}\")]),a(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v(\",\")]),s._v(\"\\n    \"),a(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v(\"{\")]),s._v(\"\\n      \"),a(\"span\",{pre:!0,attrs:{class:\"token property\"}},[s._v('\"protocol\"')]),a(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[s._v(\":\")]),s._v(\" \"),a(\"span\",{pre:!0,attrs:{class:\"token string\"}},[s._v('\"blackhole\"')]),a(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v(\",\")]),s._v(\"\\n      \"),a(\"span\",{pre:!0,attrs:{class:\"token property\"}},[s._v('\"settings\"')]),a(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[s._v(\":\")]),s._v(\" \"),a(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v(\"{\")]),a(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v(\"}\")]),a(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v(\",\")]),s._v(\"\\n      \"),a(\"span\",{pre:!0,attrs:{class:\"token property\"}},[s._v('\"tag\"')]),a(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[s._v(\":\")]),s._v(\" \"),a(\"span\",{pre:!0,attrs:{class:\"token string\"}},[s._v('\"blocked\"')]),s._v(\"\\n    \"),a(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v(\"}\")]),s._v(\"\\n  \"),a(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v(\"]\")]),a(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v(\",\")]),s._v(\"\\n  \"),a(\"span\",{pre:!0,attrs:{class:\"token property\"}},[s._v('\"routing\"')]),a(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[s._v(\":\")]),s._v(\" \"),a(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v(\"{\")]),s._v(\"\\n    \"),a(\"span\",{pre:!0,attrs:{class:\"token property\"}},[s._v('\"rules\"')]),a(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[s._v(\":\")]),s._v(\" \"),a(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v(\"[\")]),s._v(\"\\n      \"),a(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v(\"{\")]),s._v(\"\\n        \"),a(\"span\",{pre:!0,attrs:{class:\"token property\"}},[s._v('\"type\"')]),a(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[s._v(\":\")]),s._v(\" \"),a(\"span\",{pre:!0,attrs:{class:\"token string\"}},[s._v('\"field\"')]),a(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v(\",\")]),s._v(\"\\n        \"),a(\"span\",{pre:!0,attrs:{class:\"token property\"}},[s._v('\"ip\"')]),a(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[s._v(\":\")]),s._v(\" \"),a(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v(\"[\")]),a(\"span\",{pre:!0,attrs:{class:\"token string\"}},[s._v('\"geoip:private\"')]),a(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v(\"]\")]),a(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v(\",\")]),s._v(\"\\n        \"),a(\"span\",{pre:!0,attrs:{class:\"token property\"}},[s._v('\"outboundTag\"')]),a(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[s._v(\":\")]),s._v(\" \"),a(\"span\",{pre:!0,attrs:{class:\"token string\"}},[s._v('\"blocked\"')]),s._v(\"\\n      \"),a(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v(\"}\")]),s._v(\"\\n    \"),a(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v(\"]\")]),s._v(\"\\n  \"),a(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v(\"}\")]),s._v(\"\\n\"),a(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v(\"}\")]),s._v(\"\\n\")])]),s._v(\" \"),a(\"div\",{staticClass:\"line-numbers-wrapper\"},[a(\"span\",{staticClass:\"line-number\"},[s._v(\"1\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[s._v(\"2\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[s._v(\"3\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[s._v(\"4\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[s._v(\"5\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[s._v(\"6\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[s._v(\"7\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[s._v(\"8\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[s._v(\"9\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[s._v(\"10\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[s._v(\"11\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[s._v(\"12\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[s._v(\"13\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[s._v(\"14\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[s._v(\"15\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[s._v(\"16\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[s._v(\"17\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[s._v(\"18\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[s._v(\"19\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[s._v(\"20\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[s._v(\"21\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[s._v(\"22\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[s._v(\"23\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[s._v(\"24\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[s._v(\"25\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[s._v(\"26\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[s._v(\"27\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[s._v(\"28\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[s._v(\"29\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[s._v(\"30\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[s._v(\"31\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[s._v(\"32\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[s._v(\"33\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[s._v(\"34\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[s._v(\"35\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[s._v(\"36\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[s._v(\"37\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[s._v(\"38\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[s._v(\"39\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[s._v(\"40\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[s._v(\"41\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[s._v(\"42\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[s._v(\"43\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[s._v(\"44\")]),a(\"br\")])]),a(\"p\",[s._v(\"修改配置文件之后需要重启 v2ray:\"),a(\"code\",[s._v(\"systemctl restart v2ray\")])]),s._v(\" \"),a(\"p\",[s._v(\"v2ray 常用操作：\")]),s._v(\" \"),a(\"div\",{staticClass:\"language-bash line-numbers-mode\"},[a(\"pre\",{pre:!0,attrs:{class:\"language-bash\"}},[a(\"code\",[a(\"span\",{pre:!0,attrs:{class:\"token comment\"}},[s._v(\"## 启动\")]),s._v(\"\\n\"),a(\"span\",{pre:!0,attrs:{class:\"token function\"}},[s._v(\"sudo\")]),s._v(\" systemctl start v2ray\\n\\n\"),a(\"span\",{pre:!0,attrs:{class:\"token comment\"}},[s._v(\"## 停止\")]),s._v(\"\\n\"),a(\"span\",{pre:!0,attrs:{class:\"token function\"}},[s._v(\"sudo\")]),s._v(\" systemctl stop v2ray\\n\\n\"),a(\"span\",{pre:!0,attrs:{class:\"token comment\"}},[s._v(\"## 重启\")]),s._v(\"\\n\"),a(\"span\",{pre:!0,attrs:{class:\"token function\"}},[s._v(\"sudo\")]),s._v(\" systemctl restart v2ray\\n\")])]),s._v(\" \"),a(\"div\",{staticClass:\"line-numbers-wrapper\"},[a(\"span\",{staticClass:\"line-number\"},[s._v(\"1\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[s._v(\"2\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[s._v(\"3\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[s._v(\"4\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[s._v(\"5\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[s._v(\"6\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[s._v(\"7\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[s._v(\"8\")]),a(\"br\")])]),a(\"h3\",{attrs:{id:\"_5-nginx\"}},[a(\"a\",{staticClass:\"header-anchor\",attrs:{href:\"#_5-nginx\"}},[s._v(\"#\")]),s._v(\" 5.nginx\")]),s._v(\" \"),a(\"p\",[s._v(\"Nginx (engine x) 是一个高性能的 HTTP 和反向代理服务器，Nginx 不在默认的 yum 源中，可以使用 epel 或者官网的 yum 源，这里使用 yum 源\")]),s._v(\" \"),a(\"p\",[s._v(\"方法一：直接添加 nginx 源\")]),s._v(\" \"),a(\"div\",{staticClass:\"language-bash line-numbers-mode\"},[a(\"pre\",{pre:!0,attrs:{class:\"language-bash\"}},[a(\"code\",[a(\"span\",{pre:!0,attrs:{class:\"token function\"}},[s._v(\"rpm\")]),s._v(\" -ivh http://nginx.org/packages/centos/7/noarch/RPMS/nginx-release-centos-7-0.el7.ngx.noarch.rpm\\n\")])]),s._v(\" \"),a(\"div\",{staticClass:\"line-numbers-wrapper\"},[a(\"span\",{staticClass:\"line-number\"},[s._v(\"1\")]),a(\"br\")])]),a(\"p\",[s._v(\"方法二：安装 epel 额外软件包（涵盖了常用的软件包）\")]),s._v(\" \"),a(\"div\",{staticClass:\"language-bash line-numbers-mode\"},[a(\"pre\",{pre:!0,attrs:{class:\"language-bash\"}},[a(\"code\",[s._v(\"yum \"),a(\"span\",{pre:!0,attrs:{class:\"token function\"}},[s._v(\"install\")]),s._v(\" epel-release -y\\n\")])]),s._v(\" \"),a(\"div\",{staticClass:\"line-numbers-wrapper\"},[a(\"span\",{staticClass:\"line-number\"},[s._v(\"1\")]),a(\"br\")])]),a(\"p\",[s._v(\"安装完 yum 源之后，可以查看一下（这里以 nginx 源为例，如果选择方法二安装 epel 成功后，查看仓库多了一行，有一万多个包。）\")]),s._v(\" \"),a(\"div\",{staticClass:\"language-bash line-numbers-mode\"},[a(\"pre\",{pre:!0,attrs:{class:\"language-bash\"}},[a(\"code\",[a(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v(\"[\")]),s._v(\"root@vultr v2ray\"),a(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v(\"]\")]),a(\"span\",{pre:!0,attrs:{class:\"token comment\"}},[s._v(\"# yum repolist\")]),s._v(\"\\nLoaded plugins: fastestmirror\\nLoading mirror speeds from cached hostfile\\n * base: centos.mirror.constant.com\\n * epel: fedora-epel.mirrors.tds.net\\n * extras: centos.mirror.constant.com\\n * updates: centos.mirror.constant.com\\nrepo \"),a(\"span\",{pre:!0,attrs:{class:\"token function\"}},[s._v(\"id\")]),s._v(\"                                             repo name                                                                        status\\n\"),a(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[s._v(\"!\")]),s._v(\"base/7/x86_64                                      CentOS-7 - Base                                                                  \"),a(\"span\",{pre:!0,attrs:{class:\"token number\"}},[s._v(\"10,097\")]),s._v(\"\\n*\"),a(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[s._v(\"!\")]),s._v(\"epel/x86_64                                       Extra Packages \"),a(\"span\",{pre:!0,attrs:{class:\"token keyword\"}},[s._v(\"for\")]),s._v(\" Enterprise Linux \"),a(\"span\",{pre:!0,attrs:{class:\"token number\"}},[s._v(\"7\")]),s._v(\" - x86_64                                   \"),a(\"span\",{pre:!0,attrs:{class:\"token number\"}},[s._v(\"13,447\")]),s._v(\"\\n\"),a(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[s._v(\"!\")]),s._v(\"extras/7/x86_64                                    CentOS-7 - Extras                                                                   \"),a(\"span\",{pre:!0,attrs:{class:\"token number\"}},[s._v(\"305\")]),s._v(\"\\n\"),a(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[s._v(\"!\")]),s._v(\"mongodb-org-4.0/7                                  MongoDB Repository                                                                   \"),a(\"span\",{pre:!0,attrs:{class:\"token number\"}},[s._v(\"70\")]),s._v(\"\\n\"),a(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[s._v(\"!\")]),s._v(\"nginx/x86_64                                       nginx repo                                                                          \"),a(\"span\",{pre:!0,attrs:{class:\"token number\"}},[s._v(\"168\")]),s._v(\"\\n\"),a(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[s._v(\"!\")]),s._v(\"updates/7/x86_64                                   CentOS-7 - Updates                                                                  \"),a(\"span\",{pre:!0,attrs:{class:\"token number\"}},[s._v(\"711\")]),s._v(\"\\nrepolist: \"),a(\"span\",{pre:!0,attrs:{class:\"token number\"}},[s._v(\"24,798\")]),s._v(\"\\n\")])]),s._v(\" \"),a(\"div\",{staticClass:\"line-numbers-wrapper\"},[a(\"span\",{staticClass:\"line-number\"},[s._v(\"1\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[s._v(\"2\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[s._v(\"3\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[s._v(\"4\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[s._v(\"5\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[s._v(\"6\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[s._v(\"7\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[s._v(\"8\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[s._v(\"9\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[s._v(\"10\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[s._v(\"11\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[s._v(\"12\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[s._v(\"13\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[s._v(\"14\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[s._v(\"15\")]),a(\"br\")])]),a(\"p\",[s._v(\"可以发现 nginx repo 已经安装到本机了，接下来使用 yum 安装 Nginx。\")]),s._v(\" \"),a(\"div\",{staticClass:\"language-bash line-numbers-mode\"},[a(\"pre\",{pre:!0,attrs:{class:\"language-bash\"}},[a(\"code\",[s._v(\"yum \"),a(\"span\",{pre:!0,attrs:{class:\"token function\"}},[s._v(\"install\")]),s._v(\" nginx\\n\")])]),s._v(\" \"),a(\"div\",{staticClass:\"line-numbers-wrapper\"},[a(\"span\",{staticClass:\"line-number\"},[s._v(\"1\")]),a(\"br\")])]),a(\"p\",[s._v(\"启动服务\")]),s._v(\" \"),a(\"div\",{staticClass:\"language-bash line-numbers-mode\"},[a(\"pre\",{pre:!0,attrs:{class:\"language-bash\"}},[a(\"code\",[s._v(\"systemctl start nginx\\n\")])]),s._v(\" \"),a(\"div\",{staticClass:\"line-numbers-wrapper\"},[a(\"span\",{staticClass:\"line-number\"},[s._v(\"1\")]),a(\"br\")])]),a(\"p\",[s._v(\"这时如果请求自己的链接会看到一个 nginx 的欢迎页面。\")]),s._v(\" \"),a(\"p\",[s._v(\"配置 nginx (配置目录在/etc/nginx/conf.d 目录)，在 conf.d 目录下新建文件 v2ray.conf，写入以下配置\")]),s._v(\" \"),a(\"div\",{staticClass:\"language-javascript line-numbers-mode\"},[a(\"pre\",{pre:!0,attrs:{class:\"language-javascript\"}},[a(\"code\",[s._v(\"server \"),a(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v(\"{\")]),s._v(\"\\n  listen  \"),a(\"span\",{pre:!0,attrs:{class:\"token number\"}},[s._v(\"443\")]),s._v(\" ssl\"),a(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v(\";\")]),s._v(\"\\n  ssl_certificate     \"),a(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[s._v(\"/\")]),s._v(\"usr\"),a(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[s._v(\"/\")]),s._v(\"local\"),a(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[s._v(\"/\")]),s._v(\"server\"),a(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[s._v(\"/\")]),s._v(\"cloudflare\"),a(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v(\".\")]),s._v(\"crt\"),a(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v(\";\")]),s._v(\"  ## cloudflare\"),a(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v(\".\")]),s._v(\"crt 下载\\n  ssl_certificate_key     \"),a(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[s._v(\"/\")]),s._v(\"usr\"),a(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[s._v(\"/\")]),s._v(\"local\"),a(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[s._v(\"/\")]),s._v(\"server\"),a(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[s._v(\"/\")]),s._v(\"cloudflare\"),a(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v(\".\")]),s._v(\"key\"),a(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v(\";\")]),s._v(\" ## cloudflare\"),a(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v(\".\")]),s._v(\"crt 下载\\n\\n  ssl_protocols         TLSv1 TLSv1\"),a(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v(\".\")]),a(\"span\",{pre:!0,attrs:{class:\"token number\"}},[s._v(\"1\")]),s._v(\" TLSv1\"),a(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v(\".\")]),a(\"span\",{pre:!0,attrs:{class:\"token number\"}},[s._v(\"2\")]),a(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v(\";\")]),s._v(\"\\n  ssl_ciphers           \"),a(\"span\",{pre:!0,attrs:{class:\"token constant\"}},[s._v(\"HIGH\")]),a(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v(\":\")]),a(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[s._v(\"!\")]),s._v(\"aNULL\"),a(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v(\":\")]),a(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[s._v(\"!\")]),a(\"span\",{pre:!0,attrs:{class:\"token constant\"}},[s._v(\"MD5\")]),a(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v(\";\")]),s._v(\"\\n  server_name           sky\"),a(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v(\".\")]),s._v(\"wangjian92\"),a(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v(\".\")]),s._v(\"com\"),a(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v(\";\")]),s._v(\"\\n\\n  # 真实的代理websocket请求到v2ray  websocket服务。\\n  location \"),a(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[s._v(\"/\")]),s._v(\"ray\"),a(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v(\"{\")]),s._v(\" # 与 V2Ray 配置中的 path 保持一致\\n    proxy_redirect off\"),a(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v(\";\")]),s._v(\"\\n    proxy_pass http\"),a(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v(\":\")]),a(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[s._v(\"/\")]),a(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[s._v(\"/\")]),a(\"span\",{pre:!0,attrs:{class:\"token number\"}},[s._v(\"127.0\")]),a(\"span\",{pre:!0,attrs:{class:\"token number\"}},[s._v(\".0\")]),a(\"span\",{pre:!0,attrs:{class:\"token number\"}},[s._v(\".1\")]),a(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v(\":\")]),a(\"span\",{pre:!0,attrs:{class:\"token number\"}},[s._v(\"31523\")]),a(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v(\";\")]),s._v(\" #假设WebSocket监听在环回地址的\"),a(\"span\",{pre:!0,attrs:{class:\"token number\"}},[s._v(\"10000\")]),s._v(\"端口上\\n    proxy_http_version \"),a(\"span\",{pre:!0,attrs:{class:\"token number\"}},[s._v(\"1.1\")]),a(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v(\";\")]),s._v(\"\\n    proxy_set_header Upgrade $http_upgrade\"),a(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v(\";\")]),s._v(\"\\n    proxy_set_header Connection \"),a(\"span\",{pre:!0,attrs:{class:\"token string\"}},[s._v('\"upgrade\"')]),a(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v(\";\")]),s._v(\"\\n    proxy_set_header Host $http_host\"),a(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v(\";\")]),s._v(\"\\n    # proxy_set_header Origin \"),a(\"span\",{pre:!0,attrs:{class:\"token string\"}},[s._v('\"\"')]),a(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v(\";\")]),s._v(\"\\n\\n    # Show realip \"),a(\"span\",{pre:!0,attrs:{class:\"token keyword\"}},[s._v(\"in\")]),s._v(\" v2ray access\"),a(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v(\".\")]),s._v(\"log\\n    proxy_set_header \"),a(\"span\",{pre:!0,attrs:{class:\"token constant\"}},[s._v(\"X\")]),a(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[s._v(\"-\")]),s._v(\"Real\"),a(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[s._v(\"-\")]),a(\"span\",{pre:!0,attrs:{class:\"token constant\"}},[s._v(\"IP\")]),s._v(\" $remote_addr\"),a(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v(\";\")]),s._v(\"\\n    proxy_set_header \"),a(\"span\",{pre:!0,attrs:{class:\"token constant\"}},[s._v(\"X\")]),a(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[s._v(\"-\")]),s._v(\"Forwarded\"),a(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[s._v(\"-\")]),s._v(\"For $proxy_add_x_forwarded_for\"),a(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v(\";\")]),s._v(\"\\n    proxy_connect_timeout \"),a(\"span\",{pre:!0,attrs:{class:\"token number\"}},[s._v(\"60\")]),a(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v(\";\")]),s._v(\"\\n    proxy_read_timeout \"),a(\"span\",{pre:!0,attrs:{class:\"token number\"}},[s._v(\"600\")]),a(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v(\";\")]),s._v(\"\\n    proxy_send_timeout \"),a(\"span\",{pre:!0,attrs:{class:\"token number\"}},[s._v(\"600\")]),a(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v(\";\")]),s._v(\"\\n  \"),a(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v(\"}\")]),s._v(\"\\n  error_page   \"),a(\"span\",{pre:!0,attrs:{class:\"token number\"}},[s._v(\"500\")]),s._v(\" \"),a(\"span\",{pre:!0,attrs:{class:\"token number\"}},[s._v(\"502\")]),s._v(\" \"),a(\"span\",{pre:!0,attrs:{class:\"token number\"}},[s._v(\"503\")]),s._v(\" \"),a(\"span\",{pre:!0,attrs:{class:\"token number\"}},[s._v(\"504\")]),s._v(\"  \"),a(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[s._v(\"/\")]),a(\"span\",{pre:!0,attrs:{class:\"token number\"}},[s._v(\"50\")]),s._v(\"x\"),a(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v(\".\")]),s._v(\"html\"),a(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v(\";\")]),s._v(\"\\n  location \"),a(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[s._v(\"=\")]),s._v(\" \"),a(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[s._v(\"/\")]),a(\"span\",{pre:!0,attrs:{class:\"token number\"}},[s._v(\"50\")]),s._v(\"x\"),a(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v(\".\")]),s._v(\"html \"),a(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v(\"{\")]),s._v(\"\\n    root   \"),a(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[s._v(\"/\")]),s._v(\"usr\"),a(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[s._v(\"/\")]),s._v(\"share\"),a(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[s._v(\"/\")]),s._v(\"nginx\"),a(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[s._v(\"/\")]),s._v(\"html\"),a(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v(\";\")]),s._v(\"\\n  \"),a(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v(\"}\")]),s._v(\"\\n\"),a(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v(\"}\")]),s._v(\"\\n\")])]),s._v(\" \"),a(\"div\",{staticClass:\"line-numbers-wrapper\"},[a(\"span\",{staticClass:\"line-number\"},[s._v(\"1\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[s._v(\"2\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[s._v(\"3\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[s._v(\"4\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[s._v(\"5\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[s._v(\"6\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[s._v(\"7\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[s._v(\"8\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[s._v(\"9\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[s._v(\"10\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[s._v(\"11\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[s._v(\"12\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[s._v(\"13\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[s._v(\"14\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[s._v(\"15\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[s._v(\"16\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[s._v(\"17\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[s._v(\"18\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[s._v(\"19\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[s._v(\"20\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[s._v(\"21\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[s._v(\"22\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[s._v(\"23\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[s._v(\"24\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[s._v(\"25\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[s._v(\"26\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[s._v(\"27\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[s._v(\"28\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[s._v(\"29\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[s._v(\"30\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[s._v(\"31\")]),a(\"br\")])]),a(\"ul\",[a(\"li\",[s._v(\"其中有几点注意的地方，ssl_certificate 和 ssl_certificate_key 需要在 \"),a(\"code\",[s._v(\"cloudflare\")]),s._v(\"网站 -> \"),a(\"code\",[s._v(\"SSL/TLS\")]),s._v(\" -> \"),a(\"code\",[s._v(\"Origin Server\")]),s._v(\"中 Create Certificate 并下载，\"),a(\"code\",[s._v(\"ssl_certificate_key\")]),s._v(\" 需要配置到 \"),a(\"code\",[s._v(\"PRIVATE KEY\")]),s._v(\"以\"),a(\"code\",[s._v(\".key\")]),s._v(\"为后缀，\"),a(\"code\",[s._v(\"ssl_certificate\")]),s._v(\"配置到\"),a(\"code\",[s._v(\"CERTIFICATE\")]),s._v(\"和\"),a(\"code\",[s._v(\"PRIVATE KEY\")]),s._v(\"以\"),a(\"code\",[s._v(\".crt\")]),s._v(\"为后缀。\")]),s._v(\" \"),a(\"li\",[a(\"code\",[s._v(\"server_name\")]),s._v(\"指向自己的子域名\")]),s._v(\" \"),a(\"li\",[a(\"code\",[s._v(\"proxy_pass\")]),s._v(\"配置到 v2ray 的端口（端口可在\"),a(\"code\",[s._v(\"/etc/v2ray/config.json\")]),s._v(\"中查询）\")])]),s._v(\" \"),a(\"p\",[s._v(\"修改配置后需要重启 nginx\")]),s._v(\" \"),a(\"div\",{staticClass:\"language-bash line-numbers-mode\"},[a(\"pre\",{pre:!0,attrs:{class:\"language-bash\"}},[a(\"code\",[s._v(\"systemctl restart nginx\\n\")])]),s._v(\" \"),a(\"div\",{staticClass:\"line-numbers-wrapper\"},[a(\"span\",{staticClass:\"line-number\"},[s._v(\"1\")]),a(\"br\")])]),a(\"h3\",{attrs:{id:\"链接测试\"}},[a(\"a\",{staticClass:\"header-anchor\",attrs:{href:\"#链接测试\"}},[s._v(\"#\")]),s._v(\" 链接测试\")]),s._v(\" \"),a(\"p\",[a(\"strong\",[s._v(\"测试方法一\")])]),s._v(\" \"),a(\"p\",[s._v(\"浏览器打开\"),a(\"a\",{attrs:{href:\"https://sky.wangjian92.top/\",target:\"_blank\",rel:\"noopener noreferrer\"}},[s._v(\"测试链接\"),a(\"OutboundLink\")],1),s._v(\"，输入自己的域名，发送一个 websocket 请求（注意是 wss 协议），看是否得到回应\")]),s._v(\" \"),a(\"p\",[a(\"strong\",[s._v(\"测试方法二\")]),s._v(\"（可跳过）\")]),s._v(\" \"),a(\"p\",[s._v(\"即方法一的源码，可部署在自己的 VPS 上进行测试，这里有一个 websocket 服务\"),a(\"code\",[s._v(\"websocket-starter\")]),s._v(\"，用于启动 websocket 测试 nginx 代理是否成功，默认在 3001 端口，可在\"),a(\"code\",[s._v(\"server.js\")]),s._v(\"中修改\")]),s._v(\" \"),a(\"div\",{staticClass:\"language-bash line-numbers-mode\"},[a(\"pre\",{pre:!0,attrs:{class:\"language-bash\"}},[a(\"code\",[a(\"span\",{pre:!0,attrs:{class:\"token function\"}},[s._v(\"git\")]),s._v(\" clone https://github.com/wangjian92/websocket-starter.git\\n\"),a(\"span\",{pre:!0,attrs:{class:\"token builtin class-name\"}},[s._v(\"cd\")]),s._v(\" ./websocket-starter\\n\"),a(\"span\",{pre:!0,attrs:{class:\"token function\"}},[s._v(\"npm\")]),s._v(\" \"),a(\"span\",{pre:!0,attrs:{class:\"token function\"}},[s._v(\"install\")]),s._v(\"\\n\"),a(\"span\",{pre:!0,attrs:{class:\"token function\"}},[s._v(\"npm\")]),s._v(\" start\\n\")])]),s._v(\" \"),a(\"div\",{staticClass:\"line-numbers-wrapper\"},[a(\"span\",{staticClass:\"line-number\"},[s._v(\"1\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[s._v(\"2\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[s._v(\"3\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[s._v(\"4\")]),a(\"br\")])]),a(\"p\",[s._v(\"配置 nginx (配置目录在/etc/nginx/conf.d 目录)，在 conf.d 目录下新建文件 v2ray.conf，写入以下配置\")]),s._v(\" \"),a(\"div\",{staticClass:\"language-javascript line-numbers-mode\"},[a(\"pre\",{pre:!0,attrs:{class:\"language-javascript\"}},[a(\"code\",[s._v(\"server \"),a(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v(\"{\")]),s._v(\"\\n  listen  \"),a(\"span\",{pre:!0,attrs:{class:\"token number\"}},[s._v(\"443\")]),s._v(\" ssl\"),a(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v(\";\")]),s._v(\"\\n  ssl_certificate     \"),a(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[s._v(\"/\")]),s._v(\"usr\"),a(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[s._v(\"/\")]),s._v(\"local\"),a(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[s._v(\"/\")]),s._v(\"server\"),a(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[s._v(\"/\")]),s._v(\"cloudflare\"),a(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v(\".\")]),s._v(\"crt\"),a(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v(\";\")]),s._v(\"  ## cloudflare\"),a(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v(\".\")]),s._v(\"crt 下载\\n  ssl_certificate_key     \"),a(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[s._v(\"/\")]),s._v(\"usr\"),a(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[s._v(\"/\")]),s._v(\"local\"),a(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[s._v(\"/\")]),s._v(\"server\"),a(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[s._v(\"/\")]),s._v(\"cloudflare\"),a(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v(\".\")]),s._v(\"key\"),a(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v(\";\")]),s._v(\" ## cloudflare\"),a(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v(\".\")]),s._v(\"crt 下载\\n\\n  ssl_protocols         TLSv1 TLSv1\"),a(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v(\".\")]),a(\"span\",{pre:!0,attrs:{class:\"token number\"}},[s._v(\"1\")]),s._v(\" TLSv1\"),a(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v(\".\")]),a(\"span\",{pre:!0,attrs:{class:\"token number\"}},[s._v(\"2\")]),a(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v(\";\")]),s._v(\"\\n  ssl_ciphers           \"),a(\"span\",{pre:!0,attrs:{class:\"token constant\"}},[s._v(\"HIGH\")]),a(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v(\":\")]),a(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[s._v(\"!\")]),s._v(\"aNULL\"),a(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v(\":\")]),a(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[s._v(\"!\")]),a(\"span\",{pre:!0,attrs:{class:\"token constant\"}},[s._v(\"MD5\")]),a(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v(\";\")]),s._v(\"\\n  server_name           sky\"),a(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v(\".\")]),s._v(\"wangjian92\"),a(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v(\".\")]),s._v(\"com\"),a(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v(\";\")]),s._v(\"\\n# 测试websocket静态页面\\n  location \"),a(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[s._v(\"/\")]),a(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v(\"{\")]),s._v(\"\\n    proxy_pass http\"),a(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v(\":\")]),a(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[s._v(\"/\")]),a(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[s._v(\"/\")]),a(\"span\",{pre:!0,attrs:{class:\"token number\"}},[s._v(\"127.0\")]),a(\"span\",{pre:!0,attrs:{class:\"token number\"}},[s._v(\".0\")]),a(\"span\",{pre:!0,attrs:{class:\"token number\"}},[s._v(\".1\")]),a(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v(\":\")]),a(\"span\",{pre:!0,attrs:{class:\"token number\"}},[s._v(\"3001\")]),a(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v(\";\")]),s._v(\"\\n  \"),a(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v(\"}\")]),s._v(\"\\n# 测试 服务器跟浏览器的联通\\n  location \"),a(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[s._v(\"/\")]),s._v(\"echo\"),a(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v(\"{\")]),s._v(\"\\n    proxy_redirect off\"),a(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v(\";\")]),s._v(\"\\n    proxy_pass  http\"),a(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v(\":\")]),a(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[s._v(\"/\")]),a(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[s._v(\"/\")]),a(\"span\",{pre:!0,attrs:{class:\"token number\"}},[s._v(\"127.0\")]),a(\"span\",{pre:!0,attrs:{class:\"token number\"}},[s._v(\".0\")]),a(\"span\",{pre:!0,attrs:{class:\"token number\"}},[s._v(\".1\")]),a(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v(\":\")]),a(\"span\",{pre:!0,attrs:{class:\"token number\"}},[s._v(\"3001\")]),a(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v(\";\")]),s._v(\"\\n    proxy_http_version \"),a(\"span\",{pre:!0,attrs:{class:\"token number\"}},[s._v(\"1.1\")]),a(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v(\";\")]),s._v(\"\\n        proxy_set_header Upgrade $http_upgrade\"),a(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v(\";\")]),s._v(\"\\n        proxy_set_header Connection \"),a(\"span\",{pre:!0,attrs:{class:\"token string\"}},[s._v('\"upgrade\"')]),a(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v(\";\")]),s._v(\"\\n        proxy_set_header Host $http_host\"),a(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v(\";\")]),s._v(\"\\n        # Show realip \"),a(\"span\",{pre:!0,attrs:{class:\"token keyword\"}},[s._v(\"in\")]),s._v(\" v2ray access\"),a(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v(\".\")]),s._v(\"log\\n        proxy_set_header \"),a(\"span\",{pre:!0,attrs:{class:\"token constant\"}},[s._v(\"X\")]),a(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[s._v(\"-\")]),s._v(\"Real\"),a(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[s._v(\"-\")]),a(\"span\",{pre:!0,attrs:{class:\"token constant\"}},[s._v(\"IP\")]),s._v(\" $remote_addr\"),a(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v(\";\")]),s._v(\"\\n        proxy_set_header \"),a(\"span\",{pre:!0,attrs:{class:\"token constant\"}},[s._v(\"X\")]),a(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[s._v(\"-\")]),s._v(\"Forwarded\"),a(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[s._v(\"-\")]),s._v(\"For $proxy_add_x_forwarded_for\"),a(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v(\";\")]),s._v(\"\\n        proxy_connect_timeout \"),a(\"span\",{pre:!0,attrs:{class:\"token number\"}},[s._v(\"60\")]),a(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v(\";\")]),s._v(\"\\n        proxy_read_timeout \"),a(\"span\",{pre:!0,attrs:{class:\"token number\"}},[s._v(\"600\")]),a(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v(\";\")]),s._v(\"\\n        proxy_send_timeout \"),a(\"span\",{pre:!0,attrs:{class:\"token number\"}},[s._v(\"600\")]),a(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v(\";\")]),s._v(\"\\n  \"),a(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v(\"}\")]),s._v(\"\\n# 真实的代理websocket请求到v2ray  websocket服务。\\n  location \"),a(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[s._v(\"/\")]),s._v(\"ray\"),a(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v(\"{\")]),s._v(\" # 与 V2Ray 配置中的 path 保持一致\\n        proxy_redirect off\"),a(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v(\";\")]),s._v(\"\\n        proxy_pass http\"),a(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v(\":\")]),a(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[s._v(\"/\")]),a(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[s._v(\"/\")]),a(\"span\",{pre:!0,attrs:{class:\"token number\"}},[s._v(\"127.0\")]),a(\"span\",{pre:!0,attrs:{class:\"token number\"}},[s._v(\".0\")]),a(\"span\",{pre:!0,attrs:{class:\"token number\"}},[s._v(\".1\")]),a(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v(\":\")]),a(\"span\",{pre:!0,attrs:{class:\"token number\"}},[s._v(\"31523\")]),a(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v(\";\")]),s._v(\"#假设WebSocket监听在环回地址的\"),a(\"span\",{pre:!0,attrs:{class:\"token number\"}},[s._v(\"10000\")]),s._v(\"端口上\\n        proxy_http_version \"),a(\"span\",{pre:!0,attrs:{class:\"token number\"}},[s._v(\"1.1\")]),a(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v(\";\")]),s._v(\"\\n        proxy_set_header Upgrade $http_upgrade\"),a(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v(\";\")]),s._v(\"\\n        proxy_set_header Connection \"),a(\"span\",{pre:!0,attrs:{class:\"token string\"}},[s._v('\"upgrade\"')]),a(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v(\";\")]),s._v(\"\\n        proxy_set_header Host $http_host\"),a(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v(\";\")]),s._v(\"\\n        proxy_set_header Origin \"),a(\"span\",{pre:!0,attrs:{class:\"token string\"}},[s._v('\"\"')]),a(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v(\";\")]),s._v(\"\\n\\n        # Show realip \"),a(\"span\",{pre:!0,attrs:{class:\"token keyword\"}},[s._v(\"in\")]),s._v(\" v2ray access\"),a(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v(\".\")]),s._v(\"log\\n        proxy_set_header \"),a(\"span\",{pre:!0,attrs:{class:\"token constant\"}},[s._v(\"X\")]),a(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[s._v(\"-\")]),s._v(\"Real\"),a(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[s._v(\"-\")]),a(\"span\",{pre:!0,attrs:{class:\"token constant\"}},[s._v(\"IP\")]),s._v(\" $remote_addr\"),a(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v(\";\")]),s._v(\"\\n        proxy_set_header \"),a(\"span\",{pre:!0,attrs:{class:\"token constant\"}},[s._v(\"X\")]),a(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[s._v(\"-\")]),s._v(\"Forwarded\"),a(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[s._v(\"-\")]),s._v(\"For $proxy_add_x_forwarded_for\"),a(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v(\";\")]),s._v(\"\\n        proxy_connect_timeout \"),a(\"span\",{pre:!0,attrs:{class:\"token number\"}},[s._v(\"60\")]),a(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v(\";\")]),s._v(\"\\n    proxy_read_timeout \"),a(\"span\",{pre:!0,attrs:{class:\"token number\"}},[s._v(\"600\")]),a(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v(\";\")]),s._v(\"\\n    proxy_send_timeout \"),a(\"span\",{pre:!0,attrs:{class:\"token number\"}},[s._v(\"600\")]),a(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v(\";\")]),s._v(\"\\n  \"),a(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v(\"}\")]),s._v(\"\\n  error_page   \"),a(\"span\",{pre:!0,attrs:{class:\"token number\"}},[s._v(\"500\")]),s._v(\" \"),a(\"span\",{pre:!0,attrs:{class:\"token number\"}},[s._v(\"502\")]),s._v(\" \"),a(\"span\",{pre:!0,attrs:{class:\"token number\"}},[s._v(\"503\")]),s._v(\" \"),a(\"span\",{pre:!0,attrs:{class:\"token number\"}},[s._v(\"504\")]),s._v(\"  \"),a(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[s._v(\"/\")]),a(\"span\",{pre:!0,attrs:{class:\"token number\"}},[s._v(\"50\")]),s._v(\"x\"),a(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v(\".\")]),s._v(\"html\"),a(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v(\";\")]),s._v(\"\\n  location \"),a(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[s._v(\"=\")]),s._v(\" \"),a(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[s._v(\"/\")]),a(\"span\",{pre:!0,attrs:{class:\"token number\"}},[s._v(\"50\")]),s._v(\"x\"),a(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v(\".\")]),s._v(\"html \"),a(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v(\"{\")]),s._v(\"\\n        root   \"),a(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[s._v(\"/\")]),s._v(\"usr\"),a(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[s._v(\"/\")]),s._v(\"share\"),a(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[s._v(\"/\")]),s._v(\"nginx\"),a(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[s._v(\"/\")]),s._v(\"html\"),a(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v(\";\")]),s._v(\"\\n  \"),a(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v(\"}\")]),s._v(\"\\n\"),a(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v(\"}\")]),s._v(\"\\n\")])]),s._v(\" \"),a(\"div\",{staticClass:\"line-numbers-wrapper\"},[a(\"span\",{staticClass:\"line-number\"},[s._v(\"1\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[s._v(\"2\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[s._v(\"3\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[s._v(\"4\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[s._v(\"5\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[s._v(\"6\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[s._v(\"7\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[s._v(\"8\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[s._v(\"9\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[s._v(\"10\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[s._v(\"11\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[s._v(\"12\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[s._v(\"13\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[s._v(\"14\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[s._v(\"15\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[s._v(\"16\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[s._v(\"17\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[s._v(\"18\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[s._v(\"19\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[s._v(\"20\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[s._v(\"21\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[s._v(\"22\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[s._v(\"23\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[s._v(\"24\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[s._v(\"25\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[s._v(\"26\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[s._v(\"27\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[s._v(\"28\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[s._v(\"29\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[s._v(\"30\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[s._v(\"31\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[s._v(\"32\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[s._v(\"33\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[s._v(\"34\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[s._v(\"35\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[s._v(\"36\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[s._v(\"37\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[s._v(\"38\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[s._v(\"39\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[s._v(\"40\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[s._v(\"41\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[s._v(\"42\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[s._v(\"43\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[s._v(\"44\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[s._v(\"45\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[s._v(\"46\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[s._v(\"47\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[s._v(\"48\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[s._v(\"49\")]),a(\"br\")])]),a(\"p\",[s._v(\"修改配置后需要重启 nginx\")]),s._v(\" \"),a(\"div\",{staticClass:\"language-bash line-numbers-mode\"},[a(\"pre\",{pre:!0,attrs:{class:\"language-bash\"}},[a(\"code\",[s._v(\"systemctl restart nginx\\n\")])]),s._v(\" \"),a(\"div\",{staticClass:\"line-numbers-wrapper\"},[a(\"span\",{staticClass:\"line-number\"},[s._v(\"1\")]),a(\"br\")])]),a(\"ul\",[a(\"li\",[s._v(\"其中有几点注意的地方，ssl_certificate 和 ssl_certificate_key 需要在 \"),a(\"code\",[s._v(\"cloudflare\")]),s._v(\" -> \"),a(\"code\",[s._v(\"SSL/TLS\")]),s._v(\" -> \"),a(\"code\",[s._v(\"Origin Server\")]),s._v(\"中 Create Certificate 并下载，\"),a(\"code\",[s._v(\"ssl_certificate_key\")]),s._v(\" 需要配置到 \"),a(\"code\",[s._v(\"PRIVATE KEY\")]),s._v(\"以\"),a(\"code\",[s._v(\".key\")]),s._v(\"为后缀，\"),a(\"code\",[s._v(\"ssl_certificate\")]),s._v(\"配置到\"),a(\"code\",[s._v(\"CERTIFICATE\")]),s._v(\"和\"),a(\"code\",[s._v(\"PRIVATE KEY\")]),s._v(\"以\"),a(\"code\",[s._v(\".crt\")]),s._v(\"为后缀。\")]),s._v(\" \"),a(\"li\",[a(\"code\",[s._v(\"server_name\")]),s._v(\"指向自己的子域名\")]),s._v(\" \"),a(\"li\",[a(\"code\",[s._v(\"proxy_pass\")]),s._v(\"分别配置到本地 \"),a(\"code\",[s._v(\"websocket-starter\")]),s._v(\" 的启动端口，和 v2ray 的端口（这个端口可在\"),a(\"code\",[s._v(\"v2ray\")]),s._v(\"配置结束后再配，端口可在\"),a(\"code\",[s._v(\"/etc/v2ray/config.json\")]),s._v(\"中查询）\")]),s._v(\" \"),a(\"li\",[s._v(\"在浏览器打开自己的地址，\"),a(\"a\",{attrs:{href:\"https://sky.wangjian92.top\",target:\"_blank\",rel:\"noopener noreferrer\"}},[s._v(\"https://sky.wangjian92.top\"),a(\"OutboundLink\")],1),s._v(\"，看是否出现一个 websocket 链接测试的页面，点击进行测试（注意要改为 wss 协议）\")])]),s._v(\" \"),a(\"div\",{staticClass:\"custom-block warning\"},[a(\"p\",{staticClass:\"custom-block-title\"},[s._v(\"注意\")]),s._v(\" \"),a(\"p\",[s._v(\"vultr 需要开放端口或者关闭防火墙才能连接\")])]),s._v(\" \"),a(\"div\",{staticClass:\"language-bash line-numbers-mode\"},[a(\"pre\",{pre:!0,attrs:{class:\"language-bash\"}},[a(\"code\",[a(\"span\",{pre:!0,attrs:{class:\"token comment\"}},[s._v(\"# 防火墙相关操作\")]),s._v(\"\\n\"),a(\"span\",{pre:!0,attrs:{class:\"token comment\"}},[s._v(\"# 查看防火状态\")]),s._v(\"\\nsystemctl status firewalld\\n\"),a(\"span\",{pre:!0,attrs:{class:\"token function\"}},[s._v(\"service\")]),s._v(\"  iptables status\\n\\n\"),a(\"span\",{pre:!0,attrs:{class:\"token comment\"}},[s._v(\"# 暂时关闭防火墙\")]),s._v(\"\\nsystemctl stop firewalld\\n\"),a(\"span\",{pre:!0,attrs:{class:\"token function\"}},[s._v(\"service\")]),s._v(\"  iptables stop\\n\\n\"),a(\"span\",{pre:!0,attrs:{class:\"token comment\"}},[s._v(\"# 永久关闭防火墙\")]),s._v(\"\\nsystemctl disable firewalld\\n\"),a(\"span\",{pre:!0,attrs:{class:\"token function\"}},[s._v(\"chkconfig\")]),s._v(\" iptables off\\n\\n\"),a(\"span\",{pre:!0,attrs:{class:\"token comment\"}},[s._v(\"# 重启防火墙\")]),s._v(\"\\nsystemctl \"),a(\"span\",{pre:!0,attrs:{class:\"token builtin class-name\"}},[s._v(\"enable\")]),s._v(\" firewalld\\n\"),a(\"span\",{pre:!0,attrs:{class:\"token function\"}},[s._v(\"service\")]),s._v(\" iptables restart\\n\")])]),s._v(\" \"),a(\"div\",{staticClass:\"line-numbers-wrapper\"},[a(\"span\",{staticClass:\"line-number\"},[s._v(\"1\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[s._v(\"2\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[s._v(\"3\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[s._v(\"4\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[s._v(\"5\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[s._v(\"6\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[s._v(\"7\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[s._v(\"8\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[s._v(\"9\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[s._v(\"10\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[s._v(\"11\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[s._v(\"12\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[s._v(\"13\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[s._v(\"14\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[s._v(\"15\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[s._v(\"16\")]),a(\"br\")])]),a(\"p\",[s._v(\"在浏览器打开自己的地址，\"),a(\"a\",{attrs:{href:\"https://sky.wangjian92.top\",target:\"_blank\",rel:\"noopener noreferrer\"}},[s._v(\"https://sky.wangjian92.top\"),a(\"OutboundLink\")],1),s._v(\"，看是否出现一个 websocket 链接测试的页面，点击进行测试（注意要改为 wss 协议，切换/echo 和/ray 分别发请求看是否都成功），如果成功，进入客户端篇。\")]),s._v(\" \"),a(\"h2\",{attrs:{id:\"客户端篇\"}},[a(\"a\",{staticClass:\"header-anchor\",attrs:{href:\"#客户端篇\"}},[s._v(\"#\")]),s._v(\" 客户端篇\")]),s._v(\" \"),a(\"p\",[s._v(\"v2ray 官网客户端下载地址：\"),a(\"a\",{attrs:{href:\"https://github.com/v2ray/v2ray-core/releases\",target:\"_blank\",rel:\"noopener noreferrer\"}},[s._v(\"https://github.com/v2ray/v2ray-core/releases\"),a(\"OutboundLink\")],1),s._v(\"，下载适合自己系统的安装包安装\")]),s._v(\" \"),a(\"p\",[s._v(\"或者去\"),a(\"a\",{attrs:{href:\"https://www.v2ray.com/awesome/tools.html\",target:\"_blank\",rel:\"noopener noreferrer\"}},[s._v(\"v2ray 神一样的工具们\"),a(\"OutboundLink\")],1),s._v(\"选择一个图形客户端安装\")]),s._v(\" \"),a(\"h3\",{attrs:{id:\"v2ray-客户端配置\"}},[a(\"a\",{staticClass:\"header-anchor\",attrs:{href:\"#v2ray-客户端配置\"}},[s._v(\"#\")]),s._v(\" v2ray 客户端配置\")]),s._v(\" \"),a(\"p\",[s._v(\"如果下载使用图形客户端可以进入对应的配置页面配置服务器 ip 地址、端口、uuid 等信息即可，我这里以 github 的官网客户端配置文件配置为例\")]),s._v(\" \"),a(\"p\",[s._v(\"下载之后解压，修改 \"),a(\"code\",[s._v(\"config.js\")])]),s._v(\" \"),a(\"div\",{staticClass:\"language-javascript line-numbers-mode\"},[a(\"pre\",{pre:!0,attrs:{class:\"language-javascript\"}},[a(\"code\",[a(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v(\"{\")]),s._v(\"\\n  \"),a(\"span\",{pre:!0,attrs:{class:\"token string\"}},[s._v('\"inbounds\"')]),a(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v(\":\")]),s._v(\" \"),a(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v(\"[\")]),s._v(\"\\n    \"),a(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v(\"{\")]),s._v(\"\\n      \"),a(\"span\",{pre:!0,attrs:{class:\"token string\"}},[s._v('\"port\"')]),a(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v(\":\")]),s._v(\" \"),a(\"span\",{pre:!0,attrs:{class:\"token number\"}},[s._v(\"1080\")]),a(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v(\",\")]),s._v(\" \"),a(\"span\",{pre:!0,attrs:{class:\"token comment\"}},[s._v(\"// SOCKS 代理端口，在浏览器中需配置代理并指向这个端口\")]),s._v(\"\\n      \"),a(\"span\",{pre:!0,attrs:{class:\"token string\"}},[s._v('\"protocol\"')]),a(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v(\":\")]),s._v(\" \"),a(\"span\",{pre:!0,attrs:{class:\"token string\"}},[s._v('\"socks\"')]),a(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v(\",\")]),s._v(\"\\n      \"),a(\"span\",{pre:!0,attrs:{class:\"token string\"}},[s._v('\"sniffing\"')]),a(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v(\":\")]),s._v(\" \"),a(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v(\"{\")]),s._v(\"\\n        \"),a(\"span\",{pre:!0,attrs:{class:\"token string\"}},[s._v('\"enabled\"')]),a(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v(\":\")]),s._v(\" \"),a(\"span\",{pre:!0,attrs:{class:\"token boolean\"}},[s._v(\"true\")]),a(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v(\",\")]),s._v(\"\\n        \"),a(\"span\",{pre:!0,attrs:{class:\"token string\"}},[s._v('\"destOverride\"')]),a(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v(\":\")]),s._v(\" \"),a(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v(\"[\")]),a(\"span\",{pre:!0,attrs:{class:\"token string\"}},[s._v('\"http\"')]),a(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v(\",\")]),s._v(\" \"),a(\"span\",{pre:!0,attrs:{class:\"token string\"}},[s._v('\"tls\"')]),a(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v(\"]\")]),s._v(\"\\n      \"),a(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v(\"}\")]),a(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v(\",\")]),s._v(\"\\n      \"),a(\"span\",{pre:!0,attrs:{class:\"token string\"}},[s._v('\"settings\"')]),a(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v(\":\")]),s._v(\" \"),a(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v(\"{\")]),s._v(\"\\n        \"),a(\"span\",{pre:!0,attrs:{class:\"token string\"}},[s._v('\"auth\"')]),a(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v(\":\")]),s._v(\" \"),a(\"span\",{pre:!0,attrs:{class:\"token string\"}},[s._v('\"noauth\"')]),s._v(\"\\n      \"),a(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v(\"}\")]),s._v(\"\\n    \"),a(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v(\"}\")]),s._v(\"\\n  \"),a(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v(\"]\")]),a(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v(\",\")]),s._v(\"\\n  \"),a(\"span\",{pre:!0,attrs:{class:\"token string\"}},[s._v('\"outbounds\"')]),a(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v(\":\")]),s._v(\" \"),a(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v(\"[\")]),s._v(\"\\n    \"),a(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v(\"{\")]),s._v(\"\\n      \"),a(\"span\",{pre:!0,attrs:{class:\"token string\"}},[s._v('\"protocol\"')]),a(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v(\":\")]),s._v(\" \"),a(\"span\",{pre:!0,attrs:{class:\"token string\"}},[s._v('\"vmess\"')]),a(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v(\",\")]),s._v(\"\\n      \"),a(\"span\",{pre:!0,attrs:{class:\"token string\"}},[s._v('\"settings\"')]),a(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v(\":\")]),s._v(\" \"),a(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v(\"{\")]),s._v(\"\\n        \"),a(\"span\",{pre:!0,attrs:{class:\"token string\"}},[s._v('\"vnext\"')]),a(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v(\":\")]),s._v(\" \"),a(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v(\"[\")]),s._v(\"\\n          \"),a(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v(\"{\")]),s._v(\"\\n            \"),a(\"span\",{pre:!0,attrs:{class:\"token string\"}},[s._v('\"address\"')]),a(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v(\":\")]),s._v(\" \"),a(\"span\",{pre:!0,attrs:{class:\"token string\"}},[s._v('\"sky.wangjian92.top\"')]),a(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v(\",\")]),s._v(\" \"),a(\"span\",{pre:!0,attrs:{class:\"token comment\"}},[s._v(\"// 服务器地址，请修改为你自己的服务器 ip 或域名\")]),s._v(\"\\n            \"),a(\"span\",{pre:!0,attrs:{class:\"token string\"}},[s._v('\"port\"')]),a(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v(\":\")]),s._v(\" \"),a(\"span\",{pre:!0,attrs:{class:\"token number\"}},[s._v(\"443\")]),a(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v(\",\")]),s._v(\" \"),a(\"span\",{pre:!0,attrs:{class:\"token comment\"}},[s._v(\"// 服务器端口\")]),s._v(\"\\n            \"),a(\"span\",{pre:!0,attrs:{class:\"token string\"}},[s._v('\"users\"')]),a(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v(\":\")]),s._v(\" \"),a(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v(\"[\")]),s._v(\"\\n              \"),a(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v(\"{\")]),s._v(\"\\n                \"),a(\"span\",{pre:!0,attrs:{class:\"token string\"}},[s._v('\"id\"')]),a(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v(\":\")]),s._v(\" \"),a(\"span\",{pre:!0,attrs:{class:\"token string\"}},[s._v('\"******\"')]),a(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v(\",\")]),s._v(\" \"),a(\"span\",{pre:!0,attrs:{class:\"token comment\"}},[s._v(\"// 这里替换成服务器端v2ray的uuid\")]),s._v(\"\\n                \"),a(\"span\",{pre:!0,attrs:{class:\"token string\"}},[s._v('\"alterId\"')]),a(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v(\":\")]),s._v(\" \"),a(\"span\",{pre:!0,attrs:{class:\"token number\"}},[s._v(\"64\")]),s._v(\"\\n              \"),a(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v(\"}\")]),s._v(\"\\n            \"),a(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v(\"]\")]),s._v(\"\\n          \"),a(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v(\"}\")]),s._v(\"\\n        \"),a(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v(\"]\")]),s._v(\"\\n      \"),a(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v(\"}\")]),a(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v(\",\")]),s._v(\"\\n      \"),a(\"span\",{pre:!0,attrs:{class:\"token string\"}},[s._v('\"streamSettings\"')]),a(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v(\":\")]),a(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v(\"{\")]),s._v(\" \"),a(\"span\",{pre:!0,attrs:{class:\"token comment\"}},[s._v(\"// websocket配置\")]),s._v(\"\\n        \"),a(\"span\",{pre:!0,attrs:{class:\"token string\"}},[s._v('\"network\"')]),a(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v(\":\")]),a(\"span\",{pre:!0,attrs:{class:\"token string\"}},[s._v('\"ws\"')]),a(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v(\",\")]),s._v(\"\\n        \"),a(\"span\",{pre:!0,attrs:{class:\"token string\"}},[s._v('\"security\"')]),a(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v(\":\")]),s._v(\" \"),a(\"span\",{pre:!0,attrs:{class:\"token string\"}},[s._v('\"tls\"')]),a(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v(\",\")]),s._v(\"\\n        \"),a(\"span\",{pre:!0,attrs:{class:\"token string\"}},[s._v('\"wsSettings\"')]),a(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v(\":\")]),a(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v(\"{\")]),s._v(\"\\n          \"),a(\"span\",{pre:!0,attrs:{class:\"token string\"}},[s._v('\"path\"')]),a(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v(\":\")]),s._v(\" \"),a(\"span\",{pre:!0,attrs:{class:\"token string\"}},[s._v('\"/ray\"')]),s._v(\"\\n        \"),a(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v(\"}\")]),s._v(\"\\n      \"),a(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v(\"}\")]),s._v(\"\\n    \"),a(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v(\"}\")]),s._v(\"\\n  \"),a(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v(\"]\")]),s._v(\"\\n\"),a(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v(\"}\")]),s._v(\"\\n\")])]),s._v(\" \"),a(\"div\",{staticClass:\"line-numbers-wrapper\"},[a(\"span\",{staticClass:\"line-number\"},[s._v(\"1\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[s._v(\"2\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[s._v(\"3\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[s._v(\"4\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[s._v(\"5\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[s._v(\"6\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[s._v(\"7\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[s._v(\"8\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[s._v(\"9\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[s._v(\"10\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[s._v(\"11\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[s._v(\"12\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[s._v(\"13\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[s._v(\"14\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[s._v(\"15\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[s._v(\"16\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[s._v(\"17\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[s._v(\"18\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[s._v(\"19\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[s._v(\"20\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[s._v(\"21\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[s._v(\"22\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[s._v(\"23\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[s._v(\"24\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[s._v(\"25\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[s._v(\"26\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[s._v(\"27\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[s._v(\"28\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[s._v(\"29\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[s._v(\"30\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[s._v(\"31\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[s._v(\"32\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[s._v(\"33\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[s._v(\"34\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[s._v(\"35\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[s._v(\"36\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[s._v(\"37\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[s._v(\"38\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[s._v(\"39\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[s._v(\"40\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[s._v(\"41\")]),a(\"br\")])]),a(\"p\",[s._v(\"上述配置要改的地方就是服务器 IP、端口、id 和 websocket 配置，配置中已注明。上述配置会把流量转发到服务器，客户端的配置中需要确保 id 和端口与服务器端一致，就可以正常连接了。\")]),s._v(\" \"),a(\"p\",[s._v(\"客户端启动只需要双击 \"),a(\"code\",[s._v(\"v2ray.exe\")]),s._v(\" 即可运行，打开的命令行窗口不要关闭，否则会结束掉 v2ray 进程。\")]),s._v(\" \"),a(\"p\",[s._v(\"（可选）接下来需要设置代理，mac 和 windows 都可以设置全局代理，具体操作可去查询 \"),a(\"a\",{attrs:{href:\"https://support.apple.com\",target:\"_blank\",rel:\"noopener noreferrer\"}},[s._v(\"support.apple\"),a(\"OutboundLink\")],1),s._v(\" 或者 \"),a(\"a\",{attrs:{href:\"https://support.microsoft.com\",target:\"_blank\",rel:\"noopener noreferrer\"}},[s._v(\"support.microsoft\"),a(\"OutboundLink\")],1)]),s._v(\" \"),a(\"p\",[s._v(\"或者采用以配置 proxy 的姿势打开 chrome：\")]),s._v(\" \"),a(\"div\",{staticClass:\"language-bash line-numbers-mode\"},[a(\"pre\",{pre:!0,attrs:{class:\"language-bash\"}},[a(\"code\",[s._v(\"start chrome --proxy-server\"),a(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[s._v(\"=\")]),a(\"span\",{pre:!0,attrs:{class:\"token string\"}},[s._v('\"socks5://127.0.0.1:1080\"')]),s._v(\"\\n\")])]),s._v(\" \"),a(\"div\",{staticClass:\"line-numbers-wrapper\"},[a(\"span\",{staticClass:\"line-number\"},[s._v(\"1\")]),a(\"br\")])]),a(\"p\",[s._v(\"（可选）上述的 proxy 可通过谷歌插件 \"),a(\"a\",{attrs:{href:\"https://chrome.google.com/webstore/detail/proxy-switchyomega/padekgcemlokbadohgkifijomclgjgif?hl=zh-CN\",target:\"_blank\",rel:\"noopener noreferrer\"}},[s._v(\"SwitchyOmega\"),a(\"OutboundLink\")],1),s._v(\"在插件中配置。\")]),s._v(\" \"),a(\"p\",[s._v(\"其中的端口则是刚才 \"),a(\"code\",[s._v(\"config.js\")]),s._v(\" 配置的 SOCKS 代理端口，顺利的话，这时打开的浏览器则是通往新世界的“世界之窗”\")])],1)}),[],!1,null,null,null);t.default=e.exports}}]);","extractedComments":[]}